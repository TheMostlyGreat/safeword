# Fail if nested config directories/files exist (indicates setup ran from wrong directory)
NESTED_CONFIGS=$(find packages -maxdepth 2 \( \
  -name ".safeword" -o \
  -name ".safeword-project" -o \
  -name ".claude" -o \
  -name ".cursor" -o \
  -name ".dependency-cruiser*" -o \
  -name "CLAUDE.md" -o \
  -name "AGENTS.md" \
  \) 2> /dev/null)

if [ -n "$NESTED_CONFIGS" ]; then
  echo "ERROR: Found nested config files in packages/"
  echo "$NESTED_CONFIGS"
  echo ""
  echo "This happens when tools run from the wrong directory."
  echo "Fix: rm -rf packages/*/{.safeword,.safeword-project,.claude,.cursor,.dependency-cruiser*,CLAUDE.md,AGENTS.md}"
  exit 1
fi

lint-staged
